const fs=require("fs"),Express=require("express"),http=require("http"),bodyParser=require("body-parser"),spawn=require("child_process").spawn;
(function(){const l={win32:["cmd","/c","start"],darwin:["open"],linux:["xdg-open"]},h={};"undefined"!==typeof module&&module.exports&&(module.exports=h);h.runServer=function(g,c,b,a){"function"!==typeof b||a||(a=b,b=null);g=fs.realpathSync(g);const d=new Express;d.use("/",Express.static(g));d.use("/ares_cli",Express.static(__dirname));d.use(bodyParser.json());d.configure(function(){b&&(d.post("/ares_cli/@@ARES_CLOSE@@",function(e,f){b("@@ARES_CLOSE@@",f)}),d.post("/ares_cli/@@GET_URL@@",function(e,
f){b("@@GET_URL@@",f)}))});const k=http.createServer(d);k.listen(c,function(e){if(e)return a(Error(e));e=k.address().port;const f="http://localhost:"+e;a(null,{msg:"Local server running on "+f,url:f,port:e})})};h.openBrowser=function(g,c,b){let a=l[process.platform];"function"===typeof c?b=c:c&&fs.existsSync(c)&&("linux"===process.platform&&a.splice(0,1),a=a.concat([c]),"darwin"===process.platform&&(a=a.concat(["--new","--args"])));this.browserProcess=spawn(a[0],a.slice(1).concat([g]));b&&b()}})();
